# F1T 賽道分析模組 - 布局結構詳細說明

## 📋 文檔資訊
- **文檔類型**: 界面布局說明
- **創建日期**: 2025-08-27
- **模組名稱**: TrackAnalysisModule
- **檔案位置**: `modules/gui/track_analysis_module.py`

## 🏗️ 整體布局架構

### 📐 主要布局容器
```
TrackAnalysisModule (QWidget)
└── QVBoxLayout (主垂直布局)
    ├── 控制面板 (Control Panel)           [70px 高度]
    ├── 主內容區域 (QSplitter)              [可變高度]
    └── 狀態區域 (Status Area)              [固定底部]
```

## 🎛️ 頂部控制面板 (Control Panel)

### 📏 尺寸與樣式
- **高度**: 70px (固定)
- **背景色**: #f8f9fa (淺灰)
- **邊框**: 1px solid #dee2e6 + 5px 圓角
- **布局**: 雙行垂直布局

### 🔧 第一行 - 主要控制項
```
QHBoxLayout (水平布局)
├── 標題標籤: "賽道分析 - 2025 Japan R"    [字體: Microsoft YaHei 10pt Bold]
├── 彈性空間 (addStretch)
├── 重新載入按鈕: "🔄 重新載入"            [80x30px]
└── 匯出按鈕: "📄 匯出"                    [60x30px]
```

### ☑️ 第二行 - 顯示選項複選框
```
QHBoxLayout (水平布局)
├── 標籤: "顯示選項:"                      [字體: Microsoft YaHei 9pt]
├── 起始點複選框: "起始點"                 [預設勾選]
├── 結束點複選框: "結束點"                 [預設勾選]
├── 距離標記複選框: "距離標記"             [預設勾選]
├── 標籤複選框: "START/FINISH標籤"         [預設勾選]
└── 彈性空間 (addStretch)
```

## 🗺️ 主內容區域 (QSplitter)

### 📊 分割布局
- **方向**: 水平分割 (Qt.Horizontal)
- **比例**: 左側地圖 : 右側資訊 = 3:1 (600:200)
- **可調整**: 用戶可拖拽調整分割線

### 🗺️ 左側 - 賽道地圖區域
```
QGroupBox: "賽道地圖"
└── QVBoxLayout
    └── TrackMapWidget                    [最小尺寸: 400x300px]
        ├── 賽道線條 (QPainterPath 平滑曲線)
        ├── 起始點標記 (綠色圓圈, 8x8px)
        ├── 結束點標記 (紅色圓圈, 8x8px)
        ├── 距離標記 (藍色點)
        ├── START/FINISH 文字標籤
        └── 圖例 (左上角)
```

#### 🎨 TrackMapWidget 繪製元素
1. **背景**: 淺灰色 (#f0f0f0)
2. **賽道線條**: 藍色平滑曲線 (QPainterPath)
3. **起始點**: 綠色半透明圓圈 (RGB: 0,255,0,180)
4. **結束點**: 紅色半透明圓圈 (RGB: 255,0,0,180)
5. **距離標記**: 沿賽道的藍色參考點
6. **文字標籤**: START/FINISH 標記
7. **圖例**: 動態顯示啟用元素的說明

### 📊 右側 - 資訊面板
```
QGroupBox: "賽道資訊"
└── QVBoxLayout
    ├── 基本資訊區域 (Basic Info Section)
    ├── 統計資訊區域 (Statistics Section)
    └── 詳細資訊區域 (Details Section)
```

#### 📋 基本資訊區域
```
QGroupBox: "基本資訊"
├── 賽事名稱: "Japanese Grand Prix"
├── 賽道長度: "57.620 km"
├── 圈數數量: "50"
└── 座標範圍: "X(-13796 ~ 5962), Y(-7004 ~ 3135)"
```

#### 📈 統計資訊區域
```
QGroupBox: "統計資訊"
├── 最快圈: "ANT (第50圈) - 00:01:30.965000"
└── 數據品質: "良好"
```

#### 📝 詳細資訊區域
```
QGroupBox: "詳細資訊"
└── QScrollArea
    └── 位置點詳細列表 (前10個圈)
        ├── # 1: 距離=0.0m, X=1674, Y=-613
        ├── # 2: 距離=1479.5m, X=2636, Y=-1743
        ├── # 3: 距離=2814.3m, X=3504, Y=-2757
        └── ...
```

## 📊 底部狀態區域 (Status Area)

### 🎯 狀態顯示
```
QHBoxLayout (水平布局)
├── 狀態標籤: "就緒 - 分析完成"
├── 彈性空間
└── 進度指示器 (當需要時顯示)
```

## 🔄 數據流與交互

### 📥 數據載入流程
1. **初始化** → 檢查緩存 → 載入JSON數據
2. **數據處理** → 計算賽道邊界 → 生成位置點
3. **UI更新** → 更新地圖 → 更新資訊面板

### 🎮 用戶交互
1. **複選框控制** → 即時更新地圖顯示
2. **按鈕操作** → 重新載入/匯出功能
3. **地圖互動** → 懸停查看座標 (未來功能)

## 🎨 視覺設計特點

### 🌈 色彩配置
- **主背景**: 白色/淺灰
- **控制面板**: #f8f9fa (Bootstrap 淺灰)
- **邊框**: #dee2e6 (Bootstrap 邊框灰)
- **賽道線**: 藍色 (#0066cc)
- **起始點**: 綠色 (0,255,0,180)
- **結束點**: 紅色 (255,0,0,180)

### 📝 字體配置
- **標題**: Microsoft YaHei 10pt Bold
- **標籤**: Microsoft YaHei 9pt
- **內容**: 系統預設字體

### 📐 尺寸規範
- **控制面板高度**: 70px
- **按鈕尺寸**: 80x30px (重新載入), 60x30px (匯出)
- **地圖最小尺寸**: 400x300px
- **圓形標記**: 8x8px

## 🔧 響應式設計

### 📱 彈性布局
- **水平分割**: 可調整地圖與資訊面板比例
- **自動縮放**: 地圖根據容器大小自動縮放
- **滾動支援**: 詳細資訊區域支援滾動

### 🎯 使用者體驗
- **即時反饋**: 複選框變更立即生效
- **視覺提示**: 清晰的顏色和圖例
- **操作便利**: 直觀的控制元件配置

## 📋 布局優勢

### ✅ 功能優點
1. **清晰分區**: 功能區域明確分離
2. **靈活控制**: 多種顯示選項可選
3. **資訊豐富**: 完整的賽道統計資訊
4. **操作便利**: 直觀的用戶控制介面

### ✅ 技術優點
1. **模組化設計**: 各組件職責明確
2. **擴展性好**: 容易添加新功能
3. **效能優化**: 條件繪製減少開銷
4. **穩定可靠**: 完整的錯誤處理

## 🔮 未來擴展空間

### 🚀 可能的增強功能
1. **縮放平移**: 地圖縮放和平移控制
2. **點擊互動**: 點擊位置點查看詳細資訊
3. **多車手對比**: 顯示多車手的路線
4. **3D視覺化**: 立體賽道地圖顯示
5. **動態播放**: 賽事過程動畫回放

### 🎨 界面改進方向
1. **主題支援**: 深色/淺色主題切換
2. **自定義配色**: 用戶自選色彩方案
3. **布局記憶**: 記住用戶的布局偏好
4. **快速切換**: 預設顯示模式快速切換

---

## 📖 總結

這個賽道分析模組的布局採用了**三層結構**設計：
1. **頂層控制** - 功能按鈕和顯示選項
2. **主要內容** - 地圖視覺化和資訊展示
3. **底層狀態** - 系統狀態和進度反饋

整體設計遵循**用戶友好**和**功能完整**的原則，提供了直觀的操作介面和豐富的賽道分析功能。模組化的架構設計也為未來的功能擴展提供了良好的基礎。
